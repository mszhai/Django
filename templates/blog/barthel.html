{% extends 'blog/base.html' %} {% block barthel %}
<a class="active-menu" href="{% url 'barthel' %}"><i class="fa fa-desktop"></i> barthel指数</a> {% endblock %} 
{% block main %}
<div id="page-wrapper">
    <div class="header">
        <h1 class="page-header">
            Barthel指数评分量表 <small>Create new page.</small>
        </h1>
        <ol class="breadcrumb">
            <li><a href="#">Home</a></li>
            <li><a href="#">Empty</a></li>
            <li class="active">Data</li>
        </ol>
        <!-- /.row -->
        <div class="row">
            <div class="col-lg-12">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        Barthel指数评分量表
                    </div>
                    <!-- /.panel-heading -->
                    <div class="panel-body">
                        <div class="table-responsive">
                            <table class="table table-striped table-bordered table-hover" id="barthel_table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>项目</th>
                                        <th>入院评分（2017.6.2）</th>
                                        <th colspan="2">出院预测评分（2017.6.14）</th>
                                        <th>出院实际评分（）</th>
                                    </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                        <!-- /.table-responsive -->
                    </div>
                    <!-- /.panel-body -->
                </div>
                <!-- /.panel -->
            </div>
        </div>
        <!-- /.row -->
    </div>
</div>

<script type="text/javascript">
    var batthel_json = {{ batthel_json|safe }};
    var ori_data = {{ ori_data|safe }};

    function jsondata() {
        //alert(batthel_json.inhosp_no);
        //$("#exampleInputName2").val(batthel_json.inhosp_no);
        $.each(batthel_json.data, function (index, item) {
            // 2.1 Create table column for group  
            // 2.2 Create a new row and append 3 columns (ip+url, group, tags)  
            $("#barthel_table tbody").append($('<tr/>')
                .append($('<td/>').html("<input id='check" + index + "' type='checkbox' />"))
                .append($('<td/>').html(item.name))
                .append($('<td/>').html(item.current))
                .append($('<td/>').html(item.pre))
                .append($('<td/>').html("<input type='text' placeholder=''>"))
            );
        });
    }

    function oridata() {
        //alert(batthel_json.inhosp_no);
        //$("#exampleInputName2").val(batthel_json.inhosp_no);
        $("#barthel_table tbody").append($('<tr/>')
            .append($('<td/>').html('1'))
            .append($('<td/>').html(ori_data.total_score.model_name))
            .append($('<td/>').html(ori_data.total_score.admission_score))
            .append($('<td colspan="2"/>').html(ori_data.total_score.predicted_score))
            .append($('<td/>').html("<input type='text' placeholder=''>"))
        );
        $.each(ori_data.total_level.prob_distribution, function (index, item) {
            if(index == 0){
                $("#barthel_table tbody").append($('<tr/>')
                    .append($('<td rowspan="5" style="vertical-align:middle"/>').html('2'))
                    .append($('<td rowspan="5" style="vertical-align:middle"/>').html(ori_data.total_level.model_name))
                    .append($('<td rowspan="5" style="vertical-align:middle"/>').html(ori_data.total_level.admission_score))
                    .append($('<td/>').html(item.score))
                    .append($('<td/>').html(item.probability))
                    .append($('<td rowspan="5" style="vertical-align:middle"/>').html("<input type='text' placeholder=''>"))
                );
            } else {
                $("#barthel_table tbody").append($('<tr/>')
                    .append($('<td/>').html(item.score))
                    .append($('<td/>').html(item.probability))
                );
            }
        });
        $.each(ori_data.subitem_scores, function (index, item) {
            rowspan = item.prob_distribution.length;
            $.each(item.prob_distribution, function (index1, item1) {
                if(index1 == 0){
                    $("#barthel_table tbody").append($('<tr/>')
                        .append($('<td rowspan="' + rowspan + '" style="vertical-align:middle"/>').html(index + 3))
                        .append($('<td rowspan="' + rowspan + '" style="vertical-align:middle"/>').html(item.model_name))
                        .append($('<td rowspan="' + rowspan + '" style="vertical-align:middle"/>').html(item.admission_score))
                        .append($('<td/>').html(item1.score))
                        .append($('<td/>').html(item1.probability))
                        .append($('<td rowspan="' + rowspan + '" style="vertical-align:middle"/>').html("<input type='text' placeholder=''>"))
                    );
                } else{
                    $("#barthel_table tbody").append($('<tr/>')
                        .append($('<td/>').html(item1.score))
                        .append($('<td/>').html(item1.probability))
                    );
                }
            });
        });
    }

    window.onload=function(){oridata();}

</script>
{% endblock %}